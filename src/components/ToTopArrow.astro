---
import { Icon } from "astro-icon/components";
---

<button
  type="button"
  aria-label="scroll to top"
  class="to-top fixed bottom-5 right-4 z-10 rounded-full border-2 border-black bg-white p-1 transition-all duration-200 md:bottom-48 md:right-10"
>
  <Icon name="arrow-bar-up" size={24} />
  <style>
    .to-top {
      box-shadow: 1px 1px 4px #00000077;
    }
  </style>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const toTopButton = document.querySelector<HTMLElement>(".to-top");

      if (!toTopButton) return;

      const handleScroll = () => {
        const isScrolledToBottom = (window.innerHeight + window.scrollY) >= (document.documentElement.scrollHeight - 1);
        const isMobile = window.innerWidth <= 768;

        if (window.scrollY > 250) {
          toTopButton.style.opacity = "1";
        } else {
          toTopButton.style.opacity = "0";
        }

        if (isScrolledToBottom && isMobile) {
          toTopButton.style.marginBottom = "50px";
        } else {
          toTopButton.style.marginBottom = "0";
        }
      };

      document.addEventListener("scroll", handleScroll);

      toTopButton.addEventListener("click", () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });

      handleScroll();
    });
  </script>
</button>
