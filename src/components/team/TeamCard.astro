---
import { Icon } from "astro-icon/components";
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";

type ContributorData = CollectionEntry<"team">["data"] | CollectionEntry<"contributors">["data"]

interface Props {
  slug: string;
  name: ContributorData["name"];
  contacts: ContributorData["contacts"];
  avatar: ContributorData["avatar"];
}


const { name, contacts, avatar, slug } = Astro.props;
---

<div
  class="outer-box relative z-10 flex w-80 min-w-72 w-[500px] max-w-full flex-col gap-4 rounded-xl md:pb-[1.125rem]"
>
  <h3
    class="font- m-0 flex items-center gap-3 self-center px-3 pt-5 text-xl not-italic"
    id={`${slug}`}
  >
    <a
      href={`/contributors/${slug}`}
      class="hover:pointer flex items-center gap-4 !no-underline"
    >
      <span class="-mt-1 font-zeitung text-fujo-pink">{name}</span>
      <Image
        class="rounded-xl object-cover"
        width={40}
        height={40}
        src={avatar}
        alt=""
      />
    </a>
  </h3>
  <ul class="flex flex-col p-4 pb-2.5 pt-0 md:p-6 md:pb-[1.125rem] md:pt-0">
    {
      contacts.map((contact) => {
        const url = new URL(contact.url);
        return (
          <li class="mt-0">
            <a
              href={contact.url}
              class="group flex items-center gap-3 py-1.5 !no-underline"
            >
              <div class="flex rounded-lg bg-fujo-purple/10 p-2 group-hover:bg-fujo-purple/20">
                <Icon
                  size={24}
                  aria-labelledby={
                    contact.platform !== "web" ? "platform" : undefined
                  }
                  aria-label={
                    contact.platform === "web" ? "website" : undefined
                  }
                  name={contact.icon ?? "world-www"}
                  class="flex-shrink-0"
                />
              </div>
              {contact.platform !== "web" && (
                <span class="sr-only" id="platform">
                  {contact.platform}:{" "}
                </span>
              )}
              <span class="-mt-1 truncate">
                {contact.username
                  ? `@${contact.username}`
                  : `${url.hostname}${url.pathname == "/" ? "" : url.pathname}`}
              </span>
            </a>
          </li>
        );
      })
    }
  </ul>
</div>
<style>
  @property --gradient-angle {
    syntax: "<angle>";
    initial-value: 0deg;
    inherits: false;
  }

  .outer-box {
    border: 2px solid transparent;
    background:
      linear-gradient(white, white) padding-box,
      conic-gradient(
          from var(--gradient-angle),
          rgba(255, 33, 233, 0.8),
          rgba(67, 96, 247, 0.8),
          rgba(255, 33, 233, 0.8),
          rgba(67, 96, 247, 0.8),
          rgba(255, 33, 233, 0.8)
        )
        border-box;
    transition:
      box-shadow 0.2s ease,
      transform 0.2s ease;
  }

  .outer-box:hover {
    box-shadow: 0 0 15px rgba(255, 33, 233, 0.15);
    transform: translateY(-4px) scale(1.02);
  }

  .outer-box:global(:has(*:target)) h3 {
    font-weight: bold;
  }

  .outer-box:global(:has(*:target)) {
    background:
      linear-gradient(#ffd8fb, #ffd8fb) padding-box,
      conic-gradient(
          from var(--gradient-angle),
          rgba(255, 33, 233, 0.8),
          rgba(67, 96, 247, 0.8),
          rgba(255, 33, 233, 0.8),
          rgba(67, 96, 247, 0.8),
          rgba(255, 33, 233, 0.8)
        )
        border-box;
  }

  @media (prefers-reduced-motion: no-preference) {
    .outer-box {
      animation: rotate-gradient 6s linear infinite;
    }

    /* Stagger animation start for each card */
    .outer-box:nth-child(6n + 1) { animation-delay: 0s; }
    .outer-box:nth-child(6n + 2) { animation-delay: -1s; }
    .outer-box:nth-child(6n + 3) { animation-delay: -2s; }
    .outer-box:nth-child(6n + 4) { animation-delay: -3s; }
    .outer-box:nth-child(6n + 5) { animation-delay: -4s; }
    .outer-box:nth-child(6n + 6) { animation-delay: -5s; }

    @keyframes rotate-gradient {
      to {
        --gradient-angle: 360deg;
      }
    }
  }
</style>
